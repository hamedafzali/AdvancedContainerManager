import{j as e}from"./charts-aae23e34.js";import{r}from"./vendor-280e31ee.js";import{a as i}from"./api-f33f6490.js";import{R as N,A as n,a as q,P as z,b as j,S as B}from"./index-e694318b.js";import{A as G}from"./alert-circle-c0f60a4e.js";import{Z as K}from"./zap-9121f5c9.js";import{E as Q}from"./eye-835cbcdc.js";import{A as W}from"./activity-ce878ae7.js";import{C as Y}from"./clock-0bcd3380.js";import{X as ee}from"./x-circle-edf1b60d.js";import{C as se}from"./check-circle-c889db5c.js";import"./utils-9456a7ed.js";function ve(){var f,b;const[d,w]=r.useState([]),[o,S]=r.useState([]),[te,C]=r.useState([]),[l,A]=r.useState(null),[k,p]=r.useState(!0),[v,y]=r.useState(null),[re,R]=r.useState(null),[ae,L]=r.useState(!1),[le,P]=r.useState(!1),[x,E]=r.useState("all"),[m,F]=r.useState("all"),[h,D]=r.useState(""),c=async()=>{try{p(!0);const[s,t,a,g]=await Promise.all([fetch(i("/api/security/scans")),fetch(i("/api/security/alerts?limit=100")),fetch(i("/api/security/policies")),fetch(i("/api/security/metrics"))]),[X,Z,_,J]=await Promise.all([s.json(),t.json(),a.json(),g.json()]);w(X.data||[]),S(Z.data||[]),C(_.data||[]),A(J.data||null)}catch(s){y(s instanceof Error?s.message:"Failed to fetch security data")}finally{p(!1)}};r.useEffect(()=>{c();const s=setInterval(c,3e4);return()=>clearInterval(s)},[]);const M=async(s,t)=>{try{if(!(await fetch(i(`/api/security/alerts/${s}`),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:t})})).ok)throw new Error("Failed to update alert");await c()}catch(a){y(a instanceof Error?a.message:"Failed to update alert")}},u=s=>{switch(s){case"critical":return"text-red-600 bg-red-50";case"high":return"text-orange-600 bg-orange-50";case"medium":return"text-yellow-600 bg-yellow-50";case"low":return"text-blue-600 bg-blue-50";case"info":return"text-gray-600 bg-gray-50";default:return"text-gray-600 bg-gray-50"}},I=s=>{switch(s){case"completed":case"pass":return e.jsx(se,{className:"w-4 h-4 text-green-600"});case"failed":case"fail":return e.jsx(ee,{className:"w-4 h-4 text-red-600"});case"running":return e.jsx(N,{className:"w-4 h-4 text-blue-600 animate-spin"});case"pending":return e.jsx(Y,{className:"w-4 h-4 text-yellow-600"});case"warning":return e.jsx(n,{className:"w-4 h-4 text-orange-600"});default:return e.jsx(W,{className:"w-4 h-4 text-gray-600"})}},T=s=>s>=80?{level:"Critical",color:"text-red-600 bg-red-50"}:s>=60?{level:"High",color:"text-orange-600 bg-orange-50"}:s>=40?{level:"Medium",color:"text-yellow-600 bg-yellow-50"}:s>=20?{level:"Low",color:"text-blue-600 bg-blue-50"}:{level:"Minimal",color:"text-green-600 bg-green-50"},$=o.filter(s=>{const t=x==="all"||s.severity===x,a=m==="all"||s.status===m,g=s.title.toLowerCase().includes(h.toLowerCase())||s.description.toLowerCase().includes(h.toLowerCase());return t&&a&&g}),V=d.reduce((s,t)=>s+t.summary.critical,0),O=d.reduce((s,t)=>s+t.summary.high,0),H=o.filter(s=>s.status==="open").length,U=o.filter(s=>s.severity==="critical"&&s.status==="open").length;return k?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(N,{className:"w-8 h-8 text-gray-400 animate-spin mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-light text-gray-900 mb-2",children:"Loading Security Data..."}),e.jsx("p",{className:"text-gray-500",children:"Fetching security scans and vulnerability data"})]})}):v?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(n,{className:"w-16 h-16 text-red-400 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-light text-gray-900 mb-2",children:"Error Loading Security Data"}),e.jsx("p",{className:"text-gray-500 mb-4",children:v}),e.jsx("button",{onClick:c,className:"px-4 py-2 bg-gray-900 hover:bg-gray-800 text-white rounded-lg transition-colors duration-200",children:"Retry"})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-8 space-y-8",children:[e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200",children:e.jsx("div",{className:"p-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-3xl font-light text-gray-900 tracking-tight",children:"Security Center"}),e.jsx("p",{className:"text-gray-500 text-sm tracking-wide",children:"Container vulnerability scanning and compliance monitoring"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{onClick:()=>P(!0),className:"flex items-center px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg transition-colors duration-200",children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),"Policies"]}),e.jsxs("button",{onClick:()=>L(!0),className:"flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors duration-200",children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),"New Scan"]})]})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-light text-gray-900",children:V}),e.jsx("div",{className:"text-sm text-gray-500",children:"Critical Vulnerabilities"})]}),e.jsx("div",{className:"p-3 bg-red-50 rounded-lg",children:e.jsx(n,{className:"w-5 h-5 text-red-600"})})]})}),e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-light text-gray-900",children:O}),e.jsx("div",{className:"text-sm text-gray-500",children:"High Vulnerabilities"})]}),e.jsx("div",{className:"p-3 bg-orange-50 rounded-lg",children:e.jsx(G,{className:"w-5 h-5 text-orange-600"})})]})}),e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-light text-gray-900",children:H}),e.jsx("div",{className:"text-sm text-gray-500",children:"Open Alerts"})]}),e.jsx("div",{className:"p-3 bg-yellow-50 rounded-lg",children:e.jsx(j,{className:"w-5 h-5 text-yellow-600"})})]})}),e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-light text-gray-900",children:U}),e.jsx("div",{className:"text-sm text-gray-500",children:"Critical Alerts"})]}),e.jsx("div",{className:"p-3 bg-red-50 rounded-lg",children:e.jsx(K,{className:"w-5 h-5 text-red-600"})})]})})]}),l&&e.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-blue-600 rounded-2xl shadow-sm border border-gray-200 p-8 text-white",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[e.jsx(j,{className:"w-8 h-8"}),e.jsx("h2",{className:"text-2xl font-light",children:"Security Posture"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Compliance Rate"}),e.jsxs("div",{className:"text-3xl font-light",children:[(f=l.complianceRate)==null?void 0:f.toFixed(1),"%"]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Average Risk Score"}),e.jsx("div",{className:"text-3xl font-light",children:(b=l.averageRiskScore)==null?void 0:b.toFixed(1)})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Total Scans"}),e.jsx("div",{className:"text-3xl font-light",children:l.totalScans})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Active Scans"}),e.jsx("div",{className:"text-3xl font-light",children:l.activeScans})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-light text-gray-900",children:"Recent Security Scans"}),e.jsx("button",{className:"text-blue-600 hover:text-blue-700 text-sm",children:"View All"})]})}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"space-y-4",children:d.slice(0,5).map(s=>{const t=T(s.riskScore);return e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:e.jsx(j,{className:"w-4 h-4 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:s.imageName}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Container: ",s.containerId," •"," ",new Date(s.timestamp).toLocaleString()]})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${u(s.status)}`,children:[I(s.status),e.jsx("span",{className:"ml-1",children:s.status})]}),e.jsxs("div",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${t.color}`,children:[t.level," (",s.riskScore,")"]}),e.jsx("button",{onClick:()=>R(s),className:"p-1.5 text-gray-600 hover:bg-gray-200 rounded",children:e.jsx(Q,{className:"w-4 h-4"})})]})]},s.id)})})})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h2",{className:"text-xl font-light text-gray-900",children:"Security Alerts"})})}),e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(B,{className:"w-4 h-4 text-gray-400 absolute left-3 top-1/2 transform -translate-y-1/2"}),e.jsx("input",{type:"text",placeholder:"Search alerts...",value:h,onChange:s=>D(s.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-gray-900 focus:border-transparent"})]}),e.jsxs("select",{value:x,onChange:s=>E(s.target.value),className:"px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-gray-900 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Severities"}),e.jsx("option",{value:"critical",children:"Critical"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"})]}),e.jsxs("select",{value:m,onChange:s=>F(s.target.value),className:"px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-gray-900 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"open",children:"Open"}),e.jsx("option",{value:"acknowledged",children:"Acknowledged"}),e.jsx("option",{value:"resolved",children:"Resolved"}),e.jsx("option",{value:"false_positive",children:"False Positive"})]})]})}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"space-y-4",children:$.slice(0,10).map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`p-2 rounded-lg ${u(s.severity)}`,children:e.jsx(n,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:s.title}),e.jsx("div",{className:"text-sm text-gray-500",children:s.description}),e.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:[s.containerId&&`Container: ${s.containerId} • `,new Date(s.timestamp).toLocaleString()]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${u(s.severity)}`,children:s.severity}),e.jsxs("select",{value:s.status,onChange:t=>M(s.id,t.target.value),className:"px-2 py-1 text-xs border border-gray-200 rounded focus:outline-none focus:ring-1 focus:ring-gray-900",children:[e.jsx("option",{value:"open",children:"Open"}),e.jsx("option",{value:"acknowledged",children:"Acknowledged"}),e.jsx("option",{value:"resolved",children:"Resolved"}),e.jsx("option",{value:"false_positive",children:"False Positive"})]})]})]},s.id))})})]})]})})}export{ve as default};
//# sourceMappingURL=Security-fa24d851.js.map
